<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <style>
        #box {
            width: 1000px;
            border: 1px solid #000;
            display: flex;
            flex-wrap: wrap;
            justify-content: space-between;
            margin: 0 auto;
        }

        #box img {
            width: 480px;
            height: 300px;
            margin-top: 10px;
        }
    </style>
</head>

<body>
    <div id="box">
        <img src="./images/loading.gif" data-src="./images/01.jpg" alt="">
        <img src="./images/loading.gif" data-src="./images/02.jpg" alt="">
        <img src="./images/loading.gif" data-src="./images/03.jpg" alt="">
        <img src="./images/loading.gif" data-src="./images/04.jpg" alt="">
        <img src="./images/loading.gif" data-src="./images/05.jpg" alt="">
        <img src="./images/loading.gif" data-src="./images/06.jpg" alt="">
        <img src="./images/loading.gif" data-src="./images/07.jpg" alt="">
        <img src="./images/loading.gif" data-src="./images/08.jpg" alt="">
        <img src="./images/loading.gif" data-src="./images/09.jpg" alt="">
        <img src="./images/loading.gif" data-src="./images/10.jpg" alt="">
        <img src="./images/loading.gif" data-src="./images/11.jpg" alt="">
        <img src="./images/loading.gif" data-src="./images/12.jpg" alt="">
        <img src="./images/loading.gif" data-src="./images/13.jpg" alt="">
        <img src="./images/loading.gif" data-src="./images/14.jpg" alt="">
        <img src="./images/loading.gif" data-src="./images/15.jpg" alt="">
        <img src="./images/loading.gif" data-src="./images/16.jpg" alt="">
        <img src="./images/loading.gif" data-src="./images/17.jpg" alt="">
        <img src="./images/loading.gif" data-src="./images/18.jpg" alt="">
        <img src="./images/loading.gif" data-src="./images/19.jpg" alt="">
        <img src="./images/loading.gif" data-src="./images/20.jpg" alt="">
        <img src="./images/loading.gif" data-src="./images/21.jpg" alt="">
        <img src="./images/loading.gif" data-src="./images/22.jpg" alt="">
        <img src="./images/loading.gif" data-src="./images/23.jpg" alt="">
        <img src="./images/loading.gif" data-src="./images/24.jpg" alt="">
        <img src="./images/loading.gif" data-src="./images/25.jpg" alt="">
        <img src="./images/loading.gif" data-src="./images/26.jpg" alt="">
        <img src="./images/loading.gif" data-src="./images/27.jpg" alt="">
        <img src="./images/loading.gif" data-src="./images/28.jpg" alt="">
        <img src="./images/loading.gif" data-src="./images/29.jpg" alt="">
        <img src="./images/loading.gif" data-src="./images/30.jpg" alt="">
    </div>
    <script>
        var oImgs = document.querySelectorAll("#box img");


        //获取元素到文档的距离
        function getEleHeigtToDoc(ele) {
            var e = ele;
            var p = {
                l: 0,
                t: 0
            };
            while (e) {
                if (e === ele) {
                    p.l += e.offsetLeft;
                    p.t += e.offsetTop;
                } else {
                    p.l += e.clientLeft + e.offsetLeft;
                    p.t += e.clientTop + e.offsetTop;
                }
                e = e.offsetParent;
            }
            return p;
        }

        window.onload = window.onscroll = function () {
            oImgs.forEach(function (item, index) {
                var toDoc = getEleHeigtToDoc(item);
                var allHeight = window.pageYOffset + document.documentElement.clientHeight;
                if (toDoc.t <= allHeight) {
                    item.src = item.dataset.src;
                }
            });
        }
    </script>
</body>

</html>